[
  {
    "id": "Vector_linux",
    "name": "Vector",
    "controller_default_run": false,
    "icon": "",
    "node_operating_system": "linux",
    "service_type": "exec",
    "executable_path": "/opt/fusion-collectors/bin/vector",
    "execute_parameters": "--config %s",
    "validation_parameters": "",
    "default_template": "",
    "introduction": "Vector is a high-performance observability data pipeline that collects, processes, and routes logs, metrics, and traces from various sources to multiple destinations, providing real-time insights into system performance and health.",
    "enabled_default_config": true,
    "default_config": {
      "nats": "# ====================================\n# 默认Logstash协议接收服务\n# ====================================\n[sources.default_logs]\ntype = \"logstash\"\naddress = \"0.0.0.0:15044\"\nmode = \"tcp\"\n# ====================================\n# 基础字段补全（最小化处理）\n# ====================================\n[transforms.default_enrich]\ntype = \"remap\"\ninputs = [\"default_logs\"]\nsource = '''\n# 添加Vector接收的基础元数据\n.collect_method = \"filebeat\"\n.node_ip = \"${node.ip}\"\n.received_at = now()\n# 确保基础字段存在\nif !exists(.timestamp) {\n  .timestamp = now()\n}\n'''\n# ====================================\n# 直接输出到NATS（零业务逻辑）\n# ====================================\n[sinks.default_vmlogs]\ntype = \"nats\"\ninputs = [\"default_enrich\"]\nsubject = \"vector\"\nurl = \"${NATS_PROTOCOL}://${NATS_SERVERS}\"\n\n[sinks.default_vmlogs.auth]\nstrategy = \"user_password\"\n\n[sinks.default_vmlogs.auth.user_password]\nuser = \"${NATS_USERNAME}\"\npassword = \"${NATS_PASSWORD}\"\n\n{% if NATS_PROTOCOL == \"tls\" %}\n# TLS 配置\n[sinks.default_vmlogs.tls]\nenabled = true\nskip_cert_verify = false\nca_file = \"${NATS_TLS_CA_FILE}\"\n{% endif %}\n\n[sinks.default_vmlogs.encoding]\ncodec = \"json\"\n",
      "add_config": "########################################\n# Source: Unix datagram socket (snmptrapd -> vector)\n########################################\n[sources.snmp_trap]\ntype = \"socket\"\nmode = \"unix_datagram\"\npath = \"/tmp/snmp_trap.sock\"\n\n[sources.snmp_trap.decoding]\ncodec = \"bytes\"\n\n########################################\n# Transform: 移除 syslog 头部，保留原始 trap 数据\n########################################\n[transforms.snmp_trap_parse]\ntype = \"remap\"\ninputs = [\"snmp_trap\"]\nsource = '''\n# 基础标记\n.collector = \"Snmptrapd\"\n.collect_type = \"snmp_trap\"\n.event_type = \"snmp_trap\"\n.node_ip = \"${node.ip}\"\n\n# 将字节转换为字符串\nmsg = string!(.message)\n\n# 移除 syslog 头部\n# 格式: <13>Nov 24 08:10:24 snmptrapd: 实际内容\nparts = split(msg, \"snmptrapd: \", 2)\nif length(parts) >= 2 {\n  .trap_message = parts[-1]\n} else {\n  .trap_message = msg\n}\n\n# 添加时间戳\n.timestamp = now()\n.received_at = now()\n'''\n\n########################################\n# Sink: NATS (发布到 subject \"vector\"，与其他日志统一)\n########################################\n[sinks.snmp_trap_nats]\ntype = \"nats\"\ninputs = [\"snmp_trap_parse\"]\nsubject = \"vector\"\nurl = \"${NATS_PROTOCOL}://${NATS_SERVERS}\"\n\n[sinks.snmp_trap_nats.auth]\nstrategy = \"user_password\"\n\n[sinks.snmp_trap_nats.auth.user_password]\nuser = \"${NATS_USERNAME}\"\npassword = \"${NATS_PASSWORD}\"\n\n{% if NATS_PROTOCOL == \"tls\" %}\n# TLS 配置\n[sinks.snmp_trap_nats.tls]\nenabled = true\nskip_cert_verify = false\nca_file = \"${NATS_TLS_CA_FILE}\"\n{% endif %}\n\n[sinks.snmp_trap_nats.encoding]\ncodec = \"json\"\n\n\n# ====================================\n# syslog 日志源（含字段映射）\n# ====================================\n[sources.syslog_base]\ntype = \"syslog\"\naddress = \"0.0.0.0:5140\"\nmode = \"tcp\"  # 也可以是 udp\n\n# ====================================\n# enrich（字段补全）\n# ====================================\n[transforms.syslog_enrich_base]\ntype = \"remap\"\ninputs = [\"syslog_base\"]\nsource = '''\n.collector = \"Vector\"\n.collect_type = \"syslog\"\n.instance_id = \"base\"\n'''\n\n# ====================================\n# sinks\n# ====================================\n[sinks.vmlogs_base]\ntype = \"nats\"\ninputs = [\"syslog_enrich_base\"]\nsubject = \"vector\"\nurl = \"${NATS_PROTOCOL}://${NATS_SERVERS}\"\n\n[sinks.vmlogs_base.auth]\nstrategy = \"user_password\"\n\n[sinks.vmlogs_base.auth.user_password]\nuser = \"${NATS_USERNAME}\"\npassword = \"${NATS_PASSWORD}\"\n\n{% if NATS_PROTOCOL == \"tls\" %}\n# TLS 配置\n[sinks.vmlogs_base.tls]\nenabled = true\nverify_certificate = true\nca_file = \"${NATS_TLS_CA_FILE}\"\n{% endif %}\n\n[sinks.vmlogs_base.encoding]\ncodec = \"json\"\n"
    },
    "tags": ["linux", "log"],
    "package_name": "vector"
  }
]
