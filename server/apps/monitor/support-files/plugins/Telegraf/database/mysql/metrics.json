{
  "plugin": "Mysql",
  "plugin_desc": "Used to collect and monitor key metrics for MySQL database health and performance.",
  "status_query": "any({instance_type='mysql', collect_type='database'}) by (instance_id)",
  "name": "Mysql",
  "icon": "mysql1",
  "type": "Database",
  "description": "",
  "default_metric": "any({instance_type='mysql'}) by (instance_id)",
  "instance_id_keys": ["instance_id"],
  "supplementary_indicators": ["mysql_threads_running", "mysql_slow_queries_rate", "mysql_innodb_buffer_pool_reads_rate"],
  "metrics": [
    {
      "metric_group": "ConnStatus",
      "name": "mysql_threads_connected",
      "display_name": "Current Connections",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "counts",
      "dimensions": [],
      "description": "Number of currently open connections; new connections are rejected when approaching max_connections",
      "query": "mysql_threads_connected{__$labels__}"
    },
    {
      "metric_group": "ConnStatus",
      "name": "mysql_threads_running",
      "display_name": "Running Threads",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "counts",
      "dimensions": [],
      "description": "Number of threads currently executing queries, reflecting concurrent processing capacity",
      "query": "mysql_threads_running{__$labels__}"
    },
    {
      "metric_group": "ConnStatus",
      "name": "mysql_aborted_connects",
      "display_name": "Aborted Connections",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "counts",
      "dimensions": [],
      "description": "Number of failed connection attempts, possibly due to permissions, network, or configuration",
      "query": "mysql_aborted_connects{__$labels__}"
    },
    {
      "metric_group": "QueryPerf",
      "name": "mysql_slow_queries_rate",
      "display_name": "Slow Query Request Trigger Rate",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "cps",
      "dimensions": [],
      "description": "Number of slow query requests, reflecting the frequency of slow queries",
      "query": "rate(mysql_slow_queries{__$labels__}[5m])"
    },
    {
      "metric_group": "QueryPerf",
      "name": "mysql_com_select_rate",
      "display_name": "SELECT Query Rate",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "cps",
      "dimensions": [],
      "description": "SELECT queries, reflecting read load trends",
      "query": "rate(mysql_com_select{__$labels__}[5m])"
    },
    {
      "metric_group": "QueryPerf",
      "name": "mysql_com_insert_rate",
      "display_name": "INSERT Write Rate",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "cps",
      "dimensions": [],
      "description": "INSERT queries, reflecting write load trends",
      "query": "rate(mysql_com_insert{__$labels__}[5m])"
    },
    {
      "metric_group": "QueryPerf",
      "name": "mysql_com_update_rate",
      "display_name": "UPDATE Update Rate",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "cps",
      "dimensions": [],
      "description": "UPDATE operations, reflecting data update frequency",
      "query": "rate(mysql_com_update{__$labels__}[5m])"
    },
    {
      "metric_group": "QueryPerf",
      "name": "mysql_com_delete_rate",
      "display_name": "DELETE Delete Rate",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "cps",
      "dimensions": [],
      "description": "DELETE operations; a spike requires checking data cleanup rationality",
      "query": "rate(mysql_com_delete{__$labels__}[5m])"
    },
    {
      "metric_group": "InnoDBPerf",
      "name": "mysql_innodb_row_lock_time_avg",
      "display_name": "Avg Row Lock Wait Time",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "ms",
      "dimensions": [],
      "description": "Average row lock wait time; >50ms indicates severe lock contention",
      "query": "mysql_innodb_row_lock_time_avg{__$labels__}"
    },
    {
      "metric_group": "InnoDBPerf",
      "name": "mysql_innodb_row_lock_waits_rate",
      "display_name": "Row Lock Waits Rate",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "cps",
      "dimensions": [],
      "description": "Number of InnoDB row lock waits",
      "query": "rate(mysql_innodb_row_lock_waits{__$labels__}[5m])"
    },
    {
      "metric_group": "InnoDBPerf",
      "name": "mysql_innodb_buffer_pool_read_requests_rate",
      "display_name": "Buffer Pool Read Requests Rate",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "cps",
      "dimensions": [],
      "description": "Buffer pool read requests, reflecting database read load",
      "query": "rate(mysql_innodb_buffer_pool_read_requests{__$labels__}[5m])"
    },
    {
      "metric_group": "InnoDBPerf",
      "name": "mysql_innodb_buffer_pool_reads_rate",
      "display_name": "Buffer Pool Disk Reads Rate",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "cps",
      "dimensions": [],
      "description": "Buffer pool disk reads; high values indicate insufficient memory",
      "query": "rate(mysql_innodb_buffer_pool_reads{__$labels__}[5m])"
    },
    {
      "metric_group": "InnoDBPerf",
      "name": "mysql_innodb_buffer_pool_pages_dirty",
      "display_name": "Dirty Pages",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "counts",
      "dimensions": [],
      "description": "Number of dirty pages in buffer pool (not yet written to disk); indicates buffer pool utilization",
      "query": "mysql_innodb_buffer_pool_pages_dirty{__$labels__}"
    },
    {
      "metric_group": "InnoDBPerf",
      "name": "mysql_innodb_buffer_pool_pages_total",
      "display_name": "Total Buffer Pool Pages",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "counts",
      "dimensions": [],
      "description": "Total pages in buffer pool; used to calculate buffer pool utilization",
      "query": "mysql_innodb_buffer_pool_pages_total{__$labels__}"
    },
    {
      "metric_group": "NetTraffic",
      "name": "mysql_bytes_received_rate",
      "display_name": "Data Received Rate",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "byteps",
      "dimensions": [],
      "description": "Data received, reflecting database input traffic",
      "query": "rate(mysql_bytes_received{__$labels__}[5m])"
    },
    {
      "metric_group": "NetTraffic",
      "name": "mysql_bytes_sent_rate",
      "display_name": "Data Sent Rate",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "byteps",
      "dimensions": [],
      "description": "Data sent, reflecting database output traffic",
      "query": "rate(mysql_bytes_sent{__$labels__}[5m])"
    },
    {
      "metric_group": "TableCache",
      "name": "mysql_table_open_cache_hits_rate",
      "display_name": "Table Cache Hits Ratio",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "percent",
      "dimensions": [],
      "description": "Table cache hit rate; <95% requires adjusting table_open_cache configuration",
      "query": "rate(mysql_table_open_cache_hits{__$labels__}[5m])"
    },
    {
      "metric_group": "TableCache",
      "name": "mysql_table_open_cache_misses_rate",
      "display_name": "Table Cache Misses Rate",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "cps",
      "dimensions": [],
      "description": "Number of table open cache miss requests, reflecting table cache hit status",
      "query": "rate(mysql_table_open_cache_misses{__$labels__}[5m])"
    },
    {
      "metric_group": "TempTable",
      "name": "mysql_created_tmp_disk_tables_rate",
      "display_name": "Disk Temporary Tables Create Rate",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "cps",
      "dimensions": [],
      "description": "Number of disk temporary tables created",
      "query": "rate(mysql_created_tmp_disk_tables{__$labels__}[5m])"
    },
    {
      "metric_group": "TempTable",
      "name": "mysql_created_tmp_tables_rate",
      "display_name": "Total Temporary Tables Create Rate",
      "instance_id_keys": ["instance_id"],
      "data_type": "Number",
      "unit": "cps",
      "dimensions": [],
      "description": "Total number of temporary tables (memory + disk) created",
      "query": "rate(mysql_created_tmp_tables{__$labels__}[5m])"
    }
  ]
}