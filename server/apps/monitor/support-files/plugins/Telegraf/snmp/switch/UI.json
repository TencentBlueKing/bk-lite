{
  "object_name": "Switch",
  "instance_type": "switch",
  "collect_type": "snmp",
  "config_type": ["switch"],
  "collector": "Telegraf",
  "instance_id": "{{cloud_region}}_{{instance_type}}_snmp_{{ip}}",
  "form_fields": [
    {
      "name": "ip",
      "label": "IP",
      "type": "input",
      "required": true,
      "visible_in": "edit",
      "editable": false,
      "description": "监控的目标主机的 IP 地址，用于标识数据收集的来源。",
      "widget_props": {
        "placeholder": "目标主机 IP"
      },
      "data_transform": {
        "origin_path": "child.content.config.agents[0]",
        "to_form": {
          "regex": "://([^:]+):"
        }
      }
    },
    {
      "name": "port",
      "label": "端口",
      "type": "inputNumber",
      "required": true,
      "editable": false,
      "default_value": 161,
      "description": "配置SNMP端口号，通常使用161端口与设备进行通信。",
      "widget_props": {
        "min": 1,
        "max": 65535,
        "placeholder": "SNMP 端口",
        "addonAfter": ""
      },
      "data_transform": {
        "origin_path": "child.content.config.agents[0]",
        "to_form": {
          "regex": ":(\\d+)$"
        }
      }
    },
    {
      "name": "version",
      "label": "版本",
      "type": "select",
      "required": true,
      "editable": false,
      "default_value": 2,
      "description": "指定要使用的 SNMP 协议版本，例如 v2c 或 v3，定义通信机制和安全级别。",
      "options": [
        { "label": "v2c", "value": 2 },
        { "label": "v3", "value": 3 }
      ],
      "widget_props": {
        "placeholder": "选择 SNMP 版本"
      },
      "data_transform": {
        "origin_path": "child.content.config.version"
      }
    },
    {
      "name": "community",
      "label": "团体名",
      "type": "input",
      "required": true,
      "default_value": "public",
      "description": "用于 SNMPv2c 的认证字符串，类似于密码，允许访问设备的 SNMP 数据。",
      "widget_props": {
        "placeholder": "SNMP Community 字符串"
      },
      "dependency": {
        "field": "version",
        "value": 2
      },
      "data_transform": {
        "origin_path": "child.content.config.community",
        "to_api": {}
      }
    },
    {
      "name": "sec_name",
      "label": "名称",
      "type": "input",
      "required": true,
      "description": "用于 SNMPv3 认证的用户名。",
      "widget_props": {
        "placeholder": "安全名称"
      },
      "dependency": {
        "field": "version",
        "value": 3
      },
      "data_transform": {
        "origin_path": "child.content.config.sec_name",
        "to_api": {}
      }
    },
    {
      "name": "sec_level",
      "label": "级别",
      "type": "select",
      "required": true,
      "default_value": "authPriv",
      "description": "安全级别设置，例如 authPriv 表示同时使用认证和隐私（加密）。",
      "options": [
        { "label": "noAuthNoPriv", "value": "noAuthNoPriv" },
        { "label": "authNoPriv", "value": "authNoPriv" },
        { "label": "authPriv", "value": "authPriv" }
      ],
      "widget_props": {
        "placeholder": "选择安全级别"
      },
      "dependency": {
        "field": "version",
        "value": 3
      },
      "data_transform": {
        "origin_path": "child.content.config.sec_level",
        "to_api": {}
      }
    },
    {
      "name": "auth_protocol",
      "label": "认证协议",
      "type": "input",
      "required": false,
      "default_value": "SHA",
      "description": "用于保护认证过程的认证协议。",
      "widget_props": {
        "placeholder": "认证协议 (MD5/SHA)"
      },
      "dependency": {
        "field": "version",
        "value": 3
      },
      "data_transform": {
        "origin_path": "child.content.config.auth_protocol",
        "to_api": {}
      }
    },
    {
      "name": "auth_password",
      "label": "认证密码",
      "type": "password",
      "required": false,
      "description": "用于认证的密码，与选择的认证协议对应。",
      "widget_props": {
        "placeholder": "认证密码"
      },
      "dependency": {
        "field": "version",
        "value": 3
      },
      "data_transform": {
        "origin_path": "child.content.config.auth_password",
        "to_api": {}
      }
    },
    {
      "name": "priv_protocol",
      "label": "加密协议",
      "type": "input",
      "required": false,
      "default_value": "AES",
      "description": "用于保护传输数据的加密协议。",
      "widget_props": {
        "placeholder": "加密协议 (DES/AES)"
      },
      "dependency": {
        "field": "version",
        "value": 3
      },
      "data_transform": {
        "origin_path": "child.content.config.priv_protocol",
        "to_api": {}
      }
    },
    {
      "name": "priv_password",
      "label": "加密密码",
      "type": "password",
      "required": false,
      "description": "用于加密的密码，与选择的加密协议对应。",
      "widget_props": {
        "placeholder": "加密密码"
      },
      "dependency": {
        "field": "version",
        "value": 3
      },
      "data_transform": {
        "origin_path": "child.content.config.priv_password",
        "to_api": {}
      }
    },
    {
      "name": "timeout",
      "label": "超时时间",
      "type": "inputNumber",
      "required": true,
      "default_value": 10,
      "description": "从设备请求数据的超时时间，超过配置时间（例如 10 秒）的请求将被视为失败。",
      "widget_props": {
        "min": 1,
        "max": 300,
        "placeholder": "超时时间（秒）",
        "addonAfter": "s"
      },
      "data_transform": {
        "origin_path": "child.content.config.timeout",
        "to_form": {
          "regex": "^(\\d+)s$"
        },
        "to_api": {
          "suffix": "s"
        }
      }
    },
    {
      "name": "interval",
      "label": "间隔",
      "type": "inputNumber",
      "required": true,
      "default_value": 10,
      "description": "监控数据的采集时间间隔（单位：秒）。",
      "widget_props": {
        "min": 1,
        "precision": 0,
        "placeholder": "采集间隔",
        "addonAfter": "s"
      },
      "data_transform": {
        "origin_path": "child.content.config.interval",
        "to_form": {
          "regex": "^(\\d+)s$"
        },
        "to_api": {
          "suffix": "s"
        }
      }
    }
  ],
  "table_columns": [
    {
      "name": "node_ids",
      "label": "节点",
      "type": "select",
      "required": true,
      "default_value": [],
      "widget_props": {
        "placeholder": "请选择节点"
      },
      "enable_row_filter": false
    },
    {
      "name": "ip",
      "label": "IP",
      "type": "input",
      "required": true,
      "default_value": "",
      "widget_props": {
        "placeholder": "请输入 IP 地址"
      },
      "change_handler": {
        "type": "simple",
        "source_fields": ["ip"],
        "target_field": "instance_name"
      }
    },
    {
      "name": "instance_name",
      "label": "实例名称",
      "type": "input",
      "required": true,
      "default_value": "",
      "widget_props": {
        "placeholder": "实例名称",
        "disabled": false
      }
    },
    {
      "name": "group_ids",
      "label": "组",
      "type": "group_select",
      "required": true,
      "default_value": [],
      "widget_props": {
        "placeholder": "请选择组"
      }
    }
  ],
  "extra_fields": {
    "agents": {
      "data_transform": {
        "origin_path": "child.content.config.agents",
        "to_api": {
          "template": "udp://{{ip}}:{{port}}",
          "array": true
        }
      }
    }
  }
}
