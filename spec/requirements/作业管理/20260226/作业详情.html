<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>作业详情 - Job</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Fira Sans', 'Fira Sans', -apple-system, BlinkMacSystemFont, 'PingFang SC', 'Microsoft YaHei', sans-serif; background: #f5f7fa; color: #1f2329; line-height: 1.5; }
        .top-header { background: #fff; height: 60px; border-bottom: 1px solid #e5e7eb;
            box-shadow: 0 1px 2px rgba(0,0,0,0.04); display: flex; align-items: center; justify-content: space-between; padding: 0 32px; position: sticky; top: 0; z-index: 100; }
        .header-left { display: flex; align-items: center; gap: 8px; }
        .logo { display: flex; align-items: center; gap: 12px; font-weight: 600; font-size: 18px; }
        .logo-icon { width: 32px; height: 32px; background: linear-gradient(135deg, #0052d9 0%, #3a84ff 50%, #699eff 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-size: 16px; font-weight: bold; box-shadow: 0 4px 12px rgba(58, 132, 255, 0.25); }
        .header-nav { display: flex; gap: 8px; margin-left: 48px; }
        .nav-item { display: flex; align-items: center; gap: 8px; color: #646a73; cursor: pointer; font-size: 14px; padding: 8px 16px; border-radius: 8px; transition: all 0.3s; font-weight: 500; }
        .nav-item:hover { color: #0052d9; background: rgba(0, 82, 217, 0.06); }
        .nav-item.active { color: #0052d9; background: rgba(0, 82, 217, 0.1); }
        .header-right { display: flex; align-items: center; gap: 20px; color: #646a73; font-size: 14px; }
        .header-right > span { cursor: pointer; padding: 6px 12px; border-radius: 6px; transition: all 0.3s; }
        .header-right > span:hover { background: rgba(0, 0, 0, 0.04); color: #0052d9; }
        .sub-header { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); height: 52px; border-bottom: 1px solid rgba(0, 0, 0, 0.06); display: flex; align-items: center; padding: 0 32px; }
        .sub-nav { display: flex; gap: 4px; }
        .sub-nav-item { padding: 10px 20px; cursor: pointer; font-size: 14px; color: #646a73; border-radius: 8px; transition: all 0.3s; font-weight: 500; }
        .sub-nav-item:hover { color: #0052d9; background: rgba(0, 82, 217, 0.06); }
        .sub-nav-item.active { color: #0052d9; background: rgba(0, 82, 217, 0.12); }
        .main-container { padding: 24px 32px; max-width: 1600px; margin: 0 auto; }
        
        .detail-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; }
        .detail-header-left { display: flex; align-items: center; gap: 16px; }
        .back-btn { width: 36px; height: 36px; border: 1px solid #dcdee0; border-radius: 8px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s; background: white; font-size: 16px; }
        .back-btn:hover { border-color: #0052d9; color: #0052d9; }
        .detail-title-group { display: flex; align-items: center; gap: 12px; }
        .detail-title { font-size: 20px; font-weight: 600; color: #1f2329; }
        .detail-id { font-size: 14px; color: #8f959e; }
        .detail-header-right { display: flex; align-items: center; gap: 12px; }
        .btn { padding: 8px 16px; border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s; border: 1px solid transparent; }
        .btn-default { background: white; border-color: #dcdee0; color: #646a73; }
        .btn-default:hover { border-color: #0052d9; color: #0052d9; }
        .btn-danger { background: #ffe6e6; border-color: #ffccc7; color: #ea3636; }
        .btn-danger:hover { background: #ffccc7; }

        .status-badge { display: inline-flex; align-items: center; gap: 6px; padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 500; }
        .status-badge.success { background: #e6fff2; color: #00a870; }
        .status-badge.failed { background: #ffe6e6; color: #ea3636; }
        .status-badge.running { background: #e6f0ff; color: #0052d9; }
        .status-dot { width: 6px; height: 6px; border-radius: 50%; background: currentColor; }
        .source-badge { padding: 4px 8px; border-radius: 4px; font-size: 12px; }
        .source-badge.manual { background: #e6f0ff; color: #0052d9; }
        .source-badge.scheduled { background: #fff4e6; color: #d46b08; }
        .source-badge.api { background: #f0f1f5; color: #646a73; }

        .info-card { background: white; border-radius: 12px; padding: 20px 24px; margin-bottom: 16px; border: 1px solid #e5e7eb; display: flex; align-items: center; justify-content: space-between; }
        .info-row { display: flex; flex-wrap: wrap; gap: 32px; flex: 1; }
        .info-item { display: flex; align-items: center; gap: 8px; }
        .info-item label { font-size: 13px; color: #8f959e; }
        .info-item span { font-size: 14px; color: #1f2329; }
        .info-actions { display: flex; align-items: center; gap: 8px; }
        .info-action-btn { display: flex; align-items: center; gap: 6px; padding: 8px 14px; border: 1px solid #dcdee0; border-radius: 6px; background: white; font-size: 13px; color: #646a73; cursor: pointer; transition: all 0.2s; }
        .info-action-btn:hover { border-color: #0052d9; color: #0052d9; background: #f0f5ff; }

        .drawer-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.4); z-index: 1000; display: none; }
        .drawer-overlay.active { display: block; }
        .drawer { position: fixed; top: 0; right: -600px; width: 600px; height: 100%; background: #f5f7fa; box-shadow: -4px 0 24px rgba(0,0,0,0.15); z-index: 1001; transition: right 0.3s ease; display: flex; flex-direction: column; }
        .drawer.active { right: 0; }
        .drawer-header { padding: 20px 24px; background: white; border-bottom: 1px solid #e5e7eb; display: flex; align-items: center; justify-content: space-between; }
        .drawer-title { font-size: 16px; font-weight: 600; color: #1f2329; }
        .drawer-close { width: 32px; height: 32px; border: none; background: transparent; font-size: 20px; color: #8f959e; cursor: pointer; border-radius: 6px; display: flex; align-items: center; justify-content: center; }
        .drawer-close:hover { background: #f5f7fa; color: #1f2329; }
        .drawer-body { flex: 1; overflow-y: auto; padding: 20px 24px; }
        .drawer-section { background: white; border-radius: 10px; border: 1px solid #e5e7eb; margin-bottom: 16px; overflow: hidden; }
        .drawer-section:last-child { margin-bottom: 0; }
        .drawer-section-header { padding: 14px 18px; border-bottom: 1px solid #e5e7eb; display: flex; align-items: center; justify-content: space-between; }
        .drawer-section-title { font-size: 14px; font-weight: 600; color: #1f2329; display: flex; align-items: center; gap: 8px; }
        .drawer-section-meta { font-size: 12px; color: #8f959e; }
        .drawer-section-actions { display: flex; gap: 8px; }
        .drawer-action-btn { padding: 5px 10px; border: 1px solid #dcdee0; border-radius: 4px; background: white; font-size: 12px; color: #646a73; cursor: pointer; display: flex; align-items: center; gap: 4px; transition: all 0.2s; }
        .drawer-action-btn:hover { border-color: #0052d9; color: #0052d9; }
        .drawer-info-grid { padding: 16px 18px; display: grid; grid-template-columns: repeat(2, 1fr); gap: 14px; }
        .drawer-info-item { display: flex; flex-direction: column; gap: 4px; }
        .drawer-info-item label { font-size: 12px; color: #8f959e; }
        .drawer-info-item span { font-size: 13px; color: #1f2329; }
        .drawer-script { background: #1e1e1e; color: #d4d4d4; padding: 16px 18px; font-family: 'Fira Code', 'Fira Code', 'Monaco', 'Menlo', monospace; font-size: 13px; line-height: 1.7; max-height: 400px; overflow-y: auto; }
        .drawer-script .line { display: flex; }
        .drawer-script .line-number { width: 36px; color: #5a5a5a; user-select: none; text-align: right; padding-right: 14px; flex-shrink: 0; }
        .drawer-script .line-code { flex: 1; white-space: pre; }
        .drawer-script .keyword { color: #569cd6; }
        .drawer-script .string { color: #ce9178; }
        .drawer-script .comment { color: #6a9955; }

        .execution-panel { display: flex; gap: 16px; height: calc(100vh - 380px); min-height: 400px; }
        .host-list-panel { width: 320px; flex-shrink: 0; background: white; border-radius: 12px; border: 1px solid #e5e7eb; display: flex; flex-direction: column; }
        .host-list-header { padding: 16px 20px; border-bottom: 1px solid #e5e7eb; display: flex; align-items: center; justify-content: space-between; }
        .host-list-title { font-size: 15px; font-weight: 600; color: #1f2329; }
        .host-stats { display: flex; gap: 12px; font-size: 12px; }
        .host-stat { display: flex; align-items: center; gap: 4px; }
        .host-stat.success { color: #00a870; }
        .host-stat.failed { color: #ea3636; }
        .host-stat.running { color: #0052d9; }
        .host-list { flex: 1; overflow-y: auto; }
        .host-item { display: flex; align-items: center; justify-content: space-between; padding: 12px 20px; cursor: pointer; transition: all 0.2s; border-bottom: 1px solid #f0f1f5; }
        .host-item:hover { background: #f9fafb; }
        .host-item.active { background: #e6f0ff; border-left: 3px solid #0052d9; }
        .host-item-info { display: flex; flex-direction: column; gap: 2px; }
        .host-item-name { font-size: 14px; font-weight: 500; color: #1f2329; }
        .host-item-ip { font-size: 12px; color: #8f959e; }
        .host-item-status { display: flex; align-items: center; gap: 8px; }
        .host-item-time { font-size: 12px; color: #8f959e; }

        .log-panel { flex: 1; background: white; border-radius: 12px; border: 1px solid #e5e7eb; display: flex; flex-direction: column; overflow: hidden; }
        .log-header { padding: 12px 20px; border-bottom: 1px solid #e5e7eb; display: flex; align-items: center; justify-content: space-between; }
        .log-header-left { display: flex; align-items: center; gap: 12px; }
        .log-title { font-size: 15px; font-weight: 600; color: #1f2329; }
        .log-host-info { font-size: 13px; color: #8f959e; }
        .log-toolbar { display: flex; align-items: center; gap: 8px; }
        .log-search { display: flex; align-items: center; border: 1px solid #dcdee0; border-radius: 6px; overflow: hidden; }
        .log-search input { padding: 6px 12px; border: none; font-size: 13px; width: 180px; outline: none; }
        .log-search input::placeholder { color: #8f959e; }
        .log-search-btn { padding: 6px 10px; background: #f5f7fa; border: none; border-left: 1px solid #dcdee0; cursor: pointer; color: #646a73; }
        .log-search-btn:hover { background: #eef0f3; color: #0052d9; }
        .log-action-btn { width: 32px; height: 32px; border: 1px solid #dcdee0; border-radius: 6px; background: white; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 14px; color: #646a73; transition: all 0.2s; }
        .log-action-btn:hover { border-color: #0052d9; color: #0052d9; }
        .log-action-btn.active { background: #e6f0ff; border-color: #0052d9; color: #0052d9; }
        .log-viewer { flex: 1; background: #1e1e1e; color: #d4d4d4; padding: 16px 20px; font-family: 'Fira Code', 'Fira Code', 'Monaco', 'Menlo', monospace; font-size: 13px; line-height: 1.7; overflow-y: auto; }
        .log-line { margin-bottom: 2px; display: flex; }
        .log-time { color: #5a5a5a; margin-right: 12px; user-select: none; }
        .log-content { flex: 1; }
        .log-content.success { color: #4ec9b0; }
        .log-content.error { color: #f48771; }
        .log-content.warning { color: #dcdcaa; }
        .log-content.info { color: #9cdcfe; }
        .log-footer { padding: 10px 20px; border-top: 1px solid #e5e7eb; display: flex; align-items: center; justify-content: space-between; font-size: 12px; color: #8f959e; }
    
        /* ===== UI/UX ENHANCEMENTS ===== */
        
        /* Focus states for accessibility */
        a:focus-visible, button:focus-visible, input:focus-visible, 
        select:focus-visible, textarea:focus-visible, 
        [tabindex]:focus-visible, .nav-item:focus-visible,
        .sub-nav-item:focus-visible {
            outline: 2px solid #0052d9;
            outline-offset: 2px;
        }

        /* Enhanced table row hover */
        tbody tr {
            border-left: 3px solid transparent;
        }
        tbody tr:hover {
            background: #f0f5ff !important;
            border-left: 3px solid #0052d9;
        }

        /* Inline SVG icon alignment */
        .nav-item svg, .sub-nav-item svg, .header-right svg {
            vertical-align: middle;
            flex-shrink: 0;
        }

        /* Reduced motion */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                transition-duration: 0.01ms !important;
            }
        }

    
        /* Drawer transform animation */
        .drawer {
            transform: translateX(100%);
            transition: transform 300ms cubic-bezier(0.4, 0, 0.2, 1);
        }
        .drawer.active {
            transform: translateX(0);
        }

    
        /* Table responsive wrapper */
        .table-responsive {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        .table-responsive table {
            min-width: 100%;
        }

    </style>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;600;700&family=Fira+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="top-header">
        <div class="header-left">
            <div class="logo"><div class="logo-icon">BK</div><span>Job</span></div>
            <nav class="header-nav">
                <div class="nav-item" onclick="location.href='首页.html'"><span style="display:inline-flex;align-items:center;"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg></span><span>首页</span></div>
                <div class="nav-item active" onclick="location.href='快速执行.html'"><span style="display:inline-flex;align-items:center;"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg></span><span>作业执行</span></div>
                <div class="nav-item" onclick="location.href='脚本库.html'"><span style="display:inline-flex;align-items:center;"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg></span><span>作业模版</span></div>
                <div class="nav-item" onclick="location.href='目标管理.html'"><span style="display:inline-flex;align-items:center;"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg></span><span>目标管理</span></div>
                <div class="nav-item" onclick="location.href='高危命令配置.html'"><span style="display:inline-flex;align-items:center;"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg></span><span>系统配置</span></div>
            </nav>
        </div>
        <div class="header-right">
            <span><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg> 帮助文档</span>
            <span><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg> 语言: 简体中文</span>
            <span><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg> Admin</span>
        </div>
    </div>

    <div class="sub-header">
        <nav class="sub-nav">
            <div class="sub-nav-item" onclick="location.href='快速执行.html'">快速执行</div>
            <div class="sub-nav-item" onclick="location.href='文件分发.html'">文件分发</div>
            <div class="sub-nav-item" onclick="location.href='定时任务.html'">定时任务</div>
            <div class="sub-nav-item active">作业记录</div>
        </nav>
    </div>

    <div class="main-container">
        <div class="detail-header">
            <div class="detail-header-left">
                <div class="back-btn" onclick="location.href='作业记录.html'">←</div>
                <div class="detail-title-group">
                    <h1 class="detail-title">清理磁盘空间</h1>
                    <span class="detail-id">#10025</span>
                    <span class="status-badge success"><span class="status-dot"></span>成功</span>
                </div>
            </div>
            <div class="detail-header-right">
                <button class="btn btn-default">重新执行</button>
            </div>
        </div>

        <div class="info-card">
            <div class="info-row">
                <div class="info-item"><label>作业类型</label><span>脚本执行</span></div>
                <div class="info-item"><label>触发来源</label><span class="source-badge manual">手动执行</span></div>
                <div class="info-item"><label>发起人</label><span>Admin</span></div>
                <div class="info-item"><label>开始时间</label><span>2026-01-20 14:23:15</span></div>
                <div class="info-item"><label>耗时</label><span>53秒</span></div>
                <div class="info-item"><label>目标主机</label><span>2 台</span></div>
                <div class="info-item"><label>执行用户</label><span>root</span></div>
                <div class="info-item"><label>超时时间</label><span>300秒</span></div>
            </div>
            <div class="info-actions">
                <button class="info-action-btn" onclick="openScriptDrawer()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg> 查看脚本</button>
            </div>
        </div>

        <div class="execution-panel">
            <div class="host-list-panel">
                <div class="host-list-header">
                    <span class="host-list-title">目标主机</span>
                    <div class="host-stats">
                        <span class="host-stat success"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: -1px;"><polyline points="20 6 9 17 4 12"/></svg> 2</span>
                        <span class="host-stat failed">× 0</span>
                    </div>
                </div>
                <div class="host-list">
                    <div class="host-item active" onclick="selectHost(0)">
                        <div class="host-item-info">
                            <span class="host-item-name">web-server-01</span>
                            <span class="host-item-ip">192.168.1.101</span>
                        </div>
                        <div class="host-item-status">
                            <span class="host-item-time">33s</span>
                            <span class="status-badge success"><span class="status-dot"></span>成功</span>
                        </div>
                    </div>
                    <div class="host-item" onclick="selectHost(1)">
                        <div class="host-item-info">
                            <span class="host-item-name">web-server-02</span>
                            <span class="host-item-ip">192.168.1.102</span>
                        </div>
                        <div class="host-item-status">
                            <span class="host-item-time">53s</span>
                            <span class="status-badge success"><span class="status-dot"></span>成功</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="log-panel">
                <div class="log-header">
                    <div class="log-header-left">
                        <span class="log-title">执行日志</span>
                        <span class="log-host-info" id="logHostInfo">web-server-01 (192.168.1.101)</span>
                    </div>
                    <div class="log-toolbar">
                        <div class="log-search">
                            <input type="text" placeholder="搜索日志..." />
                            <button class="log-search-btn"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></button>
                        </div>
                        <button class="log-action-btn" title="自动滚动" id="autoScrollBtn" onclick="toggleAutoScroll()">↓</button>
                        <button class="log-action-btn" title="复制日志" onclick="copyLogs()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></button>
                        <button class="log-action-btn" title="下载日志" onclick="downloadLogs()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg></button>
                    </div>
                </div>
                <div class="log-viewer" id="logViewer">
                    <div class="log-line"><span class="log-time">14:23:15</span><span class="log-content info">[INFO] 开始执行脚本...</span></div>
                    <div class="log-line"><span class="log-time">14:23:16</span><span class="log-content">正在清理临时文件...</span></div>
                    <div class="log-line"><span class="log-time">14:23:28</span><span class="log-content success">[SUCCESS] 成功删除 125 个临时文件</span></div>
                    <div class="log-line"><span class="log-time">14:23:28</span><span class="log-content">正在清理日志文件...</span></div>
                    <div class="log-line"><span class="log-time">14:23:45</span><span class="log-content success">[SUCCESS] 成功删除 58 个过期日志文件</span></div>
                    <div class="log-line"><span class="log-time">14:23:48</span><span class="log-content success">[SUCCESS] 磁盘清理完成</span></div>
                    <div class="log-line"><span class="log-time">14:23:48</span><span class="log-content success">[EXIT] 脚本执行成功，退出码: 0</span></div>
                </div>
                <div class="log-footer">
                    <span>共 7 行日志</span>
                    <span>最后更新: 14:23:48</span>
                </div>
            </div>
        </div>
    </div>

    <div class="drawer-overlay" id="drawerOverlay" onclick="closeScriptDrawer()"></div>
    <div class="drawer" id="scriptDrawer">
        <div class="drawer-header">
            <span class="drawer-title">脚本详情</span>
            <button class="drawer-close" onclick="closeScriptDrawer()">×</button>
        </div>
        <div class="drawer-body">
            <div class="drawer-section">
                <div class="drawer-section-header">
                    <span class="drawer-section-title"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg> 脚本信息</span>
                </div>
                <div class="drawer-info-grid">
                    <div class="drawer-info-item">
                        <label>脚本来源</label>
                        <span>手动输入</span>
                    </div>
                    <div class="drawer-info-item">
                        <label>脚本语言</label>
                        <span>Shell (Bash)</span>
                    </div>
                    <div class="drawer-info-item">
                        <label>执行用户</label>
                        <span>root</span>
                    </div>
                    <div class="drawer-info-item">
                        <label>代码行数</label>
                        <span>12 行</span>
                    </div>
                </div>
            </div>
            
            <div class="drawer-section">
                <div class="drawer-section-header">
                    <span class="drawer-section-title"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg> 脚本内容</span>
                    <div class="drawer-section-actions">
                        <button class="drawer-action-btn" onclick="copyScript()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg> 复制</button>
                    </div>
                </div>
                <div class="drawer-script">
                    <div class="line"><span class="line-number">1</span><span class="line-code"><span class="comment">#!/bin/bash</span></span></div>
                    <div class="line"><span class="line-number">2</span><span class="line-code"><span class="comment"># 磁盘清理脚本</span></span></div>
                    <div class="line"><span class="line-number">3</span><span class="line-code"></span></div>
                    <div class="line"><span class="line-number">4</span><span class="line-code"><span class="keyword">echo</span> <span class="string">"开始清理临时文件..."</span></span></div>
                    <div class="line"><span class="line-number">5</span><span class="line-code"><span class="keyword">find</span> /tmp -type f -mtime +7 -delete</span></div>
                    <div class="line"><span class="line-number">6</span><span class="line-code"><span class="keyword">echo</span> <span class="string">"临时文件清理完成"</span></span></div>
                    <div class="line"><span class="line-number">7</span><span class="line-code"></span></div>
                    <div class="line"><span class="line-number">8</span><span class="line-code"><span class="keyword">echo</span> <span class="string">"开始清理日志文件..."</span></span></div>
                    <div class="line"><span class="line-number">9</span><span class="line-code"><span class="keyword">find</span> /var/log -name <span class="string">"*.log.*"</span> -mtime +30 -delete</span></div>
                    <div class="line"><span class="line-number">10</span><span class="line-code"><span class="keyword">echo</span> <span class="string">"日志文件清理完成"</span></span></div>
                    <div class="line"><span class="line-number">11</span><span class="line-code"></span></div>
                    <div class="line"><span class="line-number">12</span><span class="line-code"><span class="keyword">echo</span> <span class="string">"磁盘清理完成"</span></span></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const hostLogs = [
            [
                { time: '14:23:15', type: 'info', text: '[INFO] 开始执行脚本...' },
                { time: '14:23:16', type: '', text: '正在清理临时文件...' },
                { time: '14:23:28', type: 'success', text: '[SUCCESS] 成功删除 125 个临时文件' },
                { time: '14:23:28', type: '', text: '正在清理日志文件...' },
                { time: '14:23:45', type: 'success', text: '[SUCCESS] 成功删除 58 个过期日志文件' },
                { time: '14:23:48', type: 'success', text: '[SUCCESS] 磁盘清理完成' },
                { time: '14:23:48', type: 'success', text: '[EXIT] 脚本执行成功，退出码: 0' }
            ],
            [
                { time: '14:23:15', type: 'info', text: '[INFO] 开始执行脚本...' },
                { time: '14:23:16', type: '', text: '正在清理临时文件...' },
                { time: '14:23:35', type: 'success', text: '[SUCCESS] 成功删除 342 个临时文件' },
                { time: '14:23:35', type: '', text: '正在清理日志文件...' },
                { time: '14:24:05', type: 'success', text: '[SUCCESS] 成功删除 186 个过期日志文件' },
                { time: '14:24:08', type: 'success', text: '[SUCCESS] 磁盘清理完成' },
                { time: '14:24:08', type: 'success', text: '[EXIT] 脚本执行成功，退出码: 0' }
            ]
        ];

        const hostInfo = [
            { name: 'web-server-01', ip: '192.168.1.101' },
            { name: 'web-server-02', ip: '192.168.1.102' }
        ];

        let currentHost = 0;
        let autoScroll = false;

        function selectHost(index) {
            currentHost = index;
            document.querySelectorAll('.host-item').forEach((el, i) => {
                el.classList.toggle('active', i === index);
            });
            document.getElementById('logHostInfo').textContent = `${hostInfo[index].name} (${hostInfo[index].ip})`;
            renderLogs();
        }

        function renderLogs() {
            const viewer = document.getElementById('logViewer');
            const logs = hostLogs[currentHost];
            viewer.innerHTML = logs.map(log => 
                `<div class="log-line"><span class="log-time">${log.time}</span><span class="log-content ${log.type}">${log.text}</span></div>`
            ).join('');
            document.querySelector('.log-footer span:first-child').textContent = `共 ${logs.length} 行日志`;
            document.querySelector('.log-footer span:last-child').textContent = `最后更新: ${logs[logs.length - 1].time}`;
        }

        function toggleScript() {
            const content = document.getElementById('scriptContent');
            const icon = document.getElementById('collapseIcon');
            content.classList.toggle('show');
            icon.classList.toggle('expanded');
        }

        function openScriptDrawer() {
            document.getElementById('drawerOverlay').classList.add('active');
            document.getElementById('scriptDrawer').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeScriptDrawer() {
            document.getElementById('drawerOverlay').classList.remove('active');
            document.getElementById('scriptDrawer').classList.remove('active');
            document.body.style.overflow = '';
        }

        function toggleAutoScroll() {
            autoScroll = !autoScroll;
            document.getElementById('autoScrollBtn').classList.toggle('active', autoScroll);
        }

        function copyLogs() {
            const logs = hostLogs[currentHost].map(l => `[${l.time}] ${l.text}`).join('\n');
            navigator.clipboard.writeText(logs);
            alert('日志已复制到剪贴板');
        }

        function downloadLogs() {
            const logs = hostLogs[currentHost].map(l => `[${l.time}] ${l.text}`).join('\n');
            const blob = new Blob([logs], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${hostInfo[currentHost].name}-logs.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
